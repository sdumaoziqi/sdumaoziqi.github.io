---
layout: post
title: debug记录
date: 2024-12-31
author: sdumaoziqi
categories:
tags: [pytorch]
comments: true
toc: true
pinned: false
---

想用tensorboard看下Qwen模型的结构，用下面代码会报错
```python
from transformers import BertModel
model = BertModel.from_pretrained('bert-base-uncased')
from torch.utils.tensorboard import SummaryWriter
writer = SummaryWriter('runs/transformer_model')
import torch
# 创建一个虚拟输入，假设输入序列长度为10，批量大小为1，词汇表大小为30522（BERT默认的词汇表大小）
example_input = torch.randint(0, 30522, (1, 10))
# 将模型和示例输入添加到TensorBoard
writer.add_graph(model, input_to_model=example_input)
writer.close()
```

```
Dictionary inputs to traced functions must have consistent type. Found Tensor and Tuple[Tuple[Tensor, Tensor], Tuple[Tensor, Tensor], Tuple[ .
```

解决办法:
在`from_pretrained()`中加上参数`torchscript=True`
